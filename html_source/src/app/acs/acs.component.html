<div class="message-contact">
  <div class="content scrolled-content">
    <div>
      <div class="">
        <ng-container>
          <table *ngIf="this.variablesService.contacts.length !== 0; else emptyList">
            <thead>
              <tr>
                <th>{{ 'CONTACTS.TABLE.NAME' | translate }}</th>
                <th>{{ 'CONTACTS.TABLE.ALIAS' | translate }}</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="
                  let contact of this.variablesService.contacts;
                  let i = index
                ">
                <tr>
                  <td>
                    {{ contact.name }}
                  </td>
                  <td>
                    <ng-container *ngIf="contact.alias">
                      <span>{{ contact.alias }}</span>
                    </ng-container>
                  </td>
                  <td>
                    <div class="button-wrapper">
                      <button [routerLink]="['/wallet/ACS/' + i]" [queryParams]="{ address: contact.address }">
                        <i class="icon transfer"></i>
                      </button>
                      <button [routerLink]="['/edit-contacts/' + i]" [queryParams]="{ id: i }">
                        <i class="icon edit"></i>
                      </button>
                      <button (click)="delete(i)">
                        <i class="icon delete"></i>
                      </button>
                    </div>
                  </td>
                </tr>
                <div class="row-divider"></div>
              </ng-container>
            </tbody>
          </table>
        </ng-container>
      <button [routerLink]="['/add-contacts']" class="message-contact-add-button">
        {{ 'CONTACTS.BUTTON.ADD' | translate }}
      </button>
    </div>
  </div>
</div>
</div>





<div class="message-column">
  <div class="message-form">
    <form *ngIf="!isLoading" class="form-send" [formGroup]="sendForm" (ngSubmit)="showDialog()">

      <div class="input-block input-block-alias" style="flex-direction: row;">
        <div class="input-block" style="margin: 2rem;">
          <label for="send-address">{{ 'SEND.USER' | translate }}</label>
          <div class="adress-input-row"><input type="text" id="send-address" formControlName="address"
              [class.required-error]="sendForm.controls['address'].dirty || sendForm.controls['address'].touched"
              [placeholder]="sendForm.controls['address'].dirty || sendForm.controls['address'].touched ? ('SEND.FORM_ERRORS.ADDRESS_REQUIRED' | translate ) : ('PLACEHOLDERS.ADRESS_PLACEHOLDER' | translate)"
              (mousedown)="addressMouseDown($event)" (contextmenu)="variablesService.onContextMenu($event)"><span
              *ngIf="currentAliasAdress" class="curent-alias-adress"
              [class.padding-bottom-01]="variablesService.settings.scale > 7.5"
              [style.left]="lenghtOfAdress + 3 + 'rem'">{{getShorterAdress()}}</span>
          </div>
          <div class="alias-dropdown scrolled-content" *ngIf="isOpen">
            <div *ngFor="let item of localAliases" (click)="setAlias(item.name)">{{item.name}}</div>
          </div>
          <div class="error-block"
            *ngIf="sendForm.controls['address'].invalid && (sendForm.controls['address'].dirty || sendForm.controls['address'].touched)">
            <div *ngIf="sendForm.controls['address'].errors['address_not_valid']">
              {{ 'SEND.FORM_ERRORS.ADDRESS_NOT_VALID' | translate }}
            </div>
            <div *ngIf="sendForm.controls['address'].errors['alias_not_valid']">
              {{ 'SEND.FORM_ERRORS.ALIAS_NOT_VALID' | translate }}
            </div>
          </div>
        </div>
        <div class="input-block" style="margin: 2rem;">
          <label for="send-amount">{{ 'SEND.TIPS' | translate }}</label>
          <input type="text" id="send-amount" formControlName="amount"
            placeholder="{{ 'PLACEHOLDERS.TIPS_PLACEHOLDER' | translate }}"
            appInputValidate="money" (contextmenu)="variablesService.onContextMenu($event)">
            <div class="error-block"
              *ngIf="sendForm.controls['amount'].invalid && !sendForm.controls['amount'].errors['required'] && (sendForm.controls['amount'].dirty || sendForm.controls['amount'].touched)">
              <div *ngIf="sendForm.controls['amount'].errors['zero']">
                {{ 'SEND.FORM_ERRORS.AMOUNT_ZERO' | translate }}
              </div>
              <div *ngIf="sendForm.controls['amount'].errors['great_than_unwraped_coins']">
                {{ 'SEND.FORM_ERRORS.GREAT_THAN_UNWRAPPED_COINS' | translate }}
              </div>
              <div *ngIf="sendForm.controls['amount'].errors['less_than_EvoX_needed']">
                {{ 'SEND.FORM_ERRORS.LESS_THAN_EvoX_NEEDED' | translate }}
              </div>
              <div *ngIf="sendForm.controls['amount'].errors['wrap_info_null']">
                {{ 'SEND.FORM_ERRORS.WRAP_INFO_NULL' | translate }}
              </div>
            </div>
        </div>
        <div class="input-block" style="margin: 2rem;">
          <label for="send-mixin">{{ 'SEND.MIXIN' | translate }}</label>
          <input type="text" id="send-mixin" formControlName="mixin"
            [class.required-error]="sendForm.controls['mixin'].dirty || sendForm.controls['mixin'].touched"
            [placeholder]="sendForm.controls['mixin'].dirty || sendForm.controls['mixin'].touched ? ('SEND.FORM_ERRORS.AMOUNT_REQUIRED' | translate ) : ('10' | translate)"
            appInputValidate="integer" (contextmenu)="variablesService.onContextMenu($event)">
        </div>
      </div>

      <div class="input-blocks-row" style="display: block;">
        <div class="input-block">
          <label for="send-comment">{{ 'SEND.MESSAGE' | translate }}</label>
          <input type="text" id="send-comment" formControlName="comment"
            placeholder="{{ 'PLACEHOLDERS.MESSAGE_PLACEHOLDER' | translate }}"
            [maxLength]="variablesService.maxCommentLength" (contextmenu)="variablesService.onContextMenu($event)">
          <div class="error-block"
            *ngIf="sendForm.get('comment').value && sendForm.get('comment').value.length >= variablesService.maxCommentLength">
            {{ 'SEND.FORM_ERRORS.MAX_LENGTH' | translate }}
          </div>
        </div>
        <button type="submit" class="blue-button" [disabled]="!sendForm.valid || !variablesService.currentWallet.loaded">{{
          'SEND.BUTTON' | translate }}</button>
        <app-send-modal *ngIf="isModalDialogVisible" [form]="sendForm" (confirmed)="confirmed($event)"></app-send-modal>
      </div>  
    </form>
  </div>






  <div class="message-history">
    <div class="history-wrap">
      <div class="wrap-table scrolled-content">
        <table class="history-table">
          <thead style="text-align: center;">
            <tr #head (window:resize)="calculateWidth()"> 
              <th>{{ 'HISTORY.STATUS' | translate }}</th> 
              <th>{{ 'HISTORY.DATE' | translate }}</th>
              <th>{{ 'SEND.USER' | translate }}</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let item of variablesService.currentWallet.history">
              <tr (click)="openDetails(item.tx_hash)" [class.locked-transaction]="!item.is_mining && item.unlock_time > 0">
                <td>
                  <div class="status" [ngClass]="item.is_income ? 'received' : 'send'">
                    <ng-container *ngIf="getHeight(item) < 10">
                      <svg class="confirmation" style="transform: rotateZ(-90deg)"
                        tooltip="{{ 'HISTORY.STATUS_TOOLTIP' | translate : {'current': getHeight(item), 'total': 10} }}"
                        placement="bottom-left" tooltipClass="table-tooltip" [delay]="500">
                        <circle stroke-dasharray="100" fill="transparent" stroke-dashoffset="0" cx="50%" cy="50%"
                          stroke="rgba(178, 0, 255, 0.33)" r="0.7rem" stroke-width="0.3rem">
                        </circle>
                        <circle class="progress-circle" cx="50%" cy="50%"
                          [style.stroke]="item.is_income ? '#E111D6' : '#AC8FEB'" r="0.7rem" fill="transparent"
                          stroke-width="0.3rem" stroke-dasharray="4.5rem" stroke-dashoffset="4.5rem" stroke-linecap="round"
                          [style.stroke-dashoffset]="strokeSize(item)"></circle>
                      </svg>
                    </ng-container>
                    <ng-container *ngIf="getHeight(item) === 10">
                      <img *ngIf="!item.is_income" class="status-transaction" src="./assets/icons/send-tab.svg" alt="">
                      <img *ngIf="item.is_income" class="status-transaction" src="./assets/icons/receive.svg" alt="">
                    </ng-container>
                    <span class="status-transaction-text">{{ (item.is_income ? 'HISTORY.RECEIVED' : 'HISTORY.SEND') |
                      translate }}</span>
                    <ng-container *ngIf="item.unlock_time !== 0 && item.tx_type !== 6">
                      <ng-container *ngIf="isLocked(item); else unlock">
                        <ng-container *ngIf="item.unlock_time < 500000000">
                          <i class="icon lock-transaction"
                            tooltip="{{ 'HISTORY.LOCK_TOOLTIP' | translate : {'date': time(item) | date : 'MM.dd.yy'} }}"
                            placement="bottom-left" tooltipClass="table-tooltip" [delay]="500"
                            [class.position]="variablesService.height_app - item.height < 10 || item.height === 0 && item.timestamp > 0"></i>
                        </ng-container>
                        <ng-container *ngIf="item.unlock_time > 500000000">
                          <i class="icon lock-transaction"
                            tooltip="{{ 'HISTORY.LOCK_TOOLTIP' | translate : {'date': item.unlock_time * 1000 | date : 'MM.dd.yy'} }}"
                            placement="bottom-left" tooltipClass="table-tooltip" [delay]="500"
                            [class.position]="variablesService.height_app - item.height < 10 || item.height === 0 && item.timestamp > 0"></i>
                        </ng-container>
                      </ng-container>
                      <ng-template #unlock>
                        <i class="icon unlock-transaction" placement="bottom-left"
                          [class.position]="variablesService.height_app - item.height < 10 || item.height === 0 && item.timestamp > 0"></i>
                      </ng-template>
                    </ng-container>
                  </div>
                </td>
                <td>{{item.timestamp * 1000 | date : 'dd-MM-yyyy HH:mm'}}</td>
                <td class="remote-address">
                  <span *ngIf="!(item.tx_type === 0 && item.remote_addresses && item.remote_addresses[0])">{{item |
                    historyTypeMessages}}</span>
                  <span *ngIf="item.tx_type === 0 && item.remote_addresses && item.remote_addresses[0]"
                    (contextmenu)="variablesService.onContextMenuOnlyCopy($event, item.remote_addresses[0])">{{item.remote_addresses[0]}}</span>
                </td>
              </tr>
              <div class="row-divider"></div>
                <tr class="transaction-details" [class.open]="item.tx_hash === openedDetails">
                  <td colspan="5">
                    <ng-container *ngIf="item.tx_hash === openedDetails">
                      <app-acs-message [transaction]="item" [sizes]="calculatedWidth"></app-acs-message>
                    </ng-container>
                  </td>
                </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
    <div class="pagination-wrapper">
      <div class="pagination">
        <div>
          <button style="border: none;" [ngClass]="{'disabled': variablesService.sync_started || wallet}"
            [disabled]="variablesService.currentWallet.currentPage === 1 || variablesService.sync_started || wallet"
            (click)="setPage(variablesService.currentWallet.currentPage - 1)">
            <svg class="icon" viewBox="0 0 17 17" width="100%" height="100%" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path
                d="M8.63281 16.3281C12.9922 16.3281 16.6016 12.7109 16.6016 8.35938C16.6016 4 12.9844 0.390625 8.625 0.390625C4.27344 0.390625 0.664062 4 0.664062 8.35938C0.664062 12.7109 4.28125 16.3281 8.63281 16.3281ZM4.49219 8.35156C4.49219 8.17188 4.55469 8.04688 4.71875 7.88281L7.4375 5.14844C7.54688 5.03906 7.6875 4.98438 7.85938 4.98438C8.19531 4.98438 8.44531 5.23438 8.44531 5.57031C8.44531 5.74219 8.36719 5.89062 8.26562 6.00781L7.26562 7L6.29688 7.8125L8 7.74219H12.1797C12.5312 7.74219 12.7891 7.99219 12.7891 8.35156C12.7891 8.70312 12.5391 8.95312 12.1797 8.95312H8L6.28906 8.89062L7.26562 9.70312L8.26562 10.6953C8.375 10.8047 8.44531 10.9531 8.44531 11.125C8.44531 11.4609 8.19531 11.7188 7.85938 11.7188C7.6875 11.7188 7.54688 11.6562 7.4375 11.5469L4.71875 8.82031C4.57031 8.67188 4.49219 8.53125 4.49219 8.35156Z"
                fill="#FDFEFF" fill-opacity="0.3" />
            </svg>
          </button>

          <ng-container *ngIf="!mining">
            <button *ngFor="let page of variablesService.currentWallet.pages"
              [class.active]="variablesService.currentWallet.currentPage === page"
              (click)="setPage(page)">{{page}}</button>
          </ng-container>

          <ng-container *ngIf="mining">
            <button
              [ngClass]="{ 'active': variablesService.currentWallet.currentPage, 'disabled': variablesService.sync_started || wallet}"
              [disabled]="stop_paginate || variablesService.sync_started || wallet"
              (click)="setPage(variablesService.currentWallet.currentPage)">
              {{variablesService.currentWallet.currentPage}}
            </button>
          </ng-container>

          <button style="border: none;" [disabled]="stop_paginate || variablesService.sync_started || wallet"
            [ngClass]="{'disabled': variablesService.sync_started || wallet}"
            (click)="setPage(variablesService.currentWallet.currentPage + 1)">
            <svg class="icon" viewBox="0 0 17 17" width="100%" height="100%" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path
                d="M8.63281 16.3281C12.9922 16.3281 16.6016 12.7109 16.6016 8.35938C16.6016 4 12.9844 0.390625 8.625 0.390625C4.27344 0.390625 0.664062 4 0.664062 8.35938C0.664062 12.7109 4.28125 16.3281 8.63281 16.3281ZM12.7656 8.35156C12.7656 8.53125 12.6953 8.67188 12.5391 8.82031L9.82031 11.5469C9.71094 11.6562 9.57031 11.7188 9.39844 11.7188C9.0625 11.7188 8.8125 11.4609 8.8125 11.125C8.8125 10.9531 8.88281 10.8047 8.99219 10.6953L9.99219 9.70312L10.9688 8.89062L9.26562 8.95312H5.07812C4.72656 8.95312 4.46875 8.70312 4.46875 8.35156C4.46875 7.99219 4.72656 7.74219 5.07812 7.74219H9.26562L10.9688 7.8125L9.99219 7L8.99219 6.00781C8.89062 5.89062 8.8125 5.74219 8.8125 5.57031C8.8125 5.23438 9.0625 4.98438 9.39844 4.98438C9.57031 4.98438 9.71094 5.03906 9.82031 5.14844L12.5391 7.88281C12.7031 8.04688 12.7656 8.17188 12.7656 8.35156Z"
                fill="#FDFEFF" fill-opacity="0.3" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>